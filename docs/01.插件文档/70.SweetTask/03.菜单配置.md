---
title: 菜单配置
date: 2025-12-08 09:04:16
permalink: /docs/task/menus
---

在此页面存放 SweetTask 的菜单配置相关说明。

## 额外点击操作

除了可以在菜单中使用 PluginBase 的[内置点击操作](elopers/base/gui-config/#自定义点击操作)以外，还可以使用以下点击操作
+ `[open]菜单名` - 打开指定菜单
+ `[back]` - 如果存在，返回上一个菜单 (仅支持本插件体系内的菜单)

## 位置

SweetTask 的菜单存放在 `plugins/SweetTask/menus` 目录中，默认有以下两个菜单
+ `default.yml`
+ `refresh-daily.yml`

你可以复制默认菜单文件，自行添加更多菜单，文件名即为菜单名。打开菜单命令详见[命令与权限](/docs/task/commands)文档。

**在[默认菜单格式](/elopers/base/gui-config/#示例配置文件)的基础上**，菜单需要符合以下其中一个模型。

## 任务菜单模型
> 源代码: [MenuModel.java](https://github.com/MrXiaoM/SweetTask/blob/main/src/main/java/top/mrxiaom/sweet/taskplugin/gui/MenuModel.java)

需要包含主要图标配置 `task-icons`，主要配置如下。

```yaml
# 打开菜单所需权限，其中 %id% 会被替换为菜单名
permission: 'sweet.task.open.%id%'
# 菜单操作选项的格式
operations:
  refresh:
    available:
      - '  &f剩余次数: &e%times%'
      - ''
      - '&a左键&7 | &f刷新今日任务'
    task-done:
      - '&c&m左键&r&7 | &f已完成过任务'
    max-times:
      - '  &f剩余次数: &e0'
      - ''
      - '&c&m左键&r&7 | &f刷新次数用完了'
  task:
    available:
      - '&a左键&7 | &f提交任务'
    done:
      - '&a&l已完成'
# 其它格式
format:
  subtasks:
    - '  &7● &f%action%'
# 菜单主要图标配置
task-icons:
  # 其中一个图标的示例
  例:
    # 格子类型，格式为 任务类型/第几个任务
    # 任务类型有 DAILY, WEEKLY, MONTHLY
    type: DAILY/1
    # 没有任务时，使用 other-icons 里的哪个图标来代替
    redirect: ''
    # 剩余格式与 PluginBase 默认图标相同
    # 其中，可以在 lore 的其中一行仅输入以下字段，在相应位置插入相关内容
    #   description - 任务描述
    #   sub_tasks   - 子任务列表，具体包装格式【在上方subtasks】有配置
    #   rewards     - 奖励列表，具体包装格式在【任务配置】中
    #   operation   - 操作选项提示，具体包装格式【在上方operations】有配置
    display: '&e&l%name%'
    lore:
      - ''
      - description
      - sub_tasks
      - ''
      - '  &f任务奖励:'
      - rewards
      - ''
      - operation
# ...菜单次要图标
other-icons:
  # 特殊地，可以在 lore 的其中一行仅输入 refresh_operation:类型 ，以显示当前某任务类型的可刷新状态。
  # 以下为示例的刷新任务按钮，点击打开 refresh-daily 菜单。
  刷:
    material: HOPPER
    display: '&e&l刷新任务'
    lore:
      - ''
      - '  &f在完成任务之前，你可以  '
      - '  &f刷新今日任务列表'
      - ''
      - refresh_operation:DAILY
    left-click-commands:
      - '[open]refresh-daily'
```

## 刷新菜单模型
> 源代码: [MenuRefreshModel.java](https://github.com/MrXiaoM/SweetTask/blob/main/src/main/java/top/mrxiaom/sweet/taskplugin/gui/MenuRefreshModel.java)

需要包含主要图标配置 `refresh-icons`，主要配置如下。

```yaml
# 要刷新的任务类型
refresh-type: DAILY
# 刷新成功提示
refresh-tips: '&a每日任务刷新成功'
# 菜单主要图标配置
refresh-icons:
  # 其中一个图标的示例
  例:
    cost:
      # 刷新所需的货币类型，其中可以使用
      #   VAULT         - 金币
      #   PLAYER_POINTS - 点券
      type: VAULT
      # 刷新所需的货币数量
      money: 100
    # 与图标相关的提示消息
    # 为了好看，应该放在图标配置最后面，但为了不引发歧义，示例配置把这个放在前面
    tips:
      # 货币不足时的提示消息
      no-money: '&e你没有足够的金币来刷新任务'
    # 剩余格式与 PluginBase 默认图标相同
    # 其中，可以使用以下变量
    #   %money%    - 刷新所需货币数量
    #   %count%    - 在当前任务类型，剩余可用的刷新数量
    #   %remain%   - 与%count%相同
    #   %current%  - 在当前任务类型，玩家当前已刷新次数
    #   %max%      - 在当前任务类型，玩家最多可以刷新多少次
    material: GOLD_INGOT
    display: '&e&l刷新'
    lore:
      - ''
      - '  &f在完成过任务之前，你可以刷新任务列表  '
      - '  &f剩余次数: %count%'
      - '  &f价格: &e%money% 金币'
      - ''
      - '&a左键 &7| &f确认刷新'
# ...菜单次要图标
other-icons: {}
```

如果想要扩展刷新图标的 `cost.type` 配置所支持的货币实现，可以参考以下代码：
+ [`RefreshIcon#load(Menus, String, ConfigurationSection, String)`](https://github.com/MrXiaoM/SweetTask/blob/3be31d80a9dc6c0fdb659c20b9daebe87c661ee5/src/main/java/top/mrxiaom/sweet/taskplugin/gui/RefreshIcon.java#L51-L67)
+ [`SweetTask#getEconomy(String)`](https://github.com/MrXiaoM/SweetTask/blob/3be31d80a9dc6c0fdb659c20b9daebe87c661ee5/src/main/java/top/mrxiaom/sweet/taskplugin/SweetTask.java#L88-L91)

PRs welcome.
