---
title: 搜索功能
date: 2026-02-20 12:07:43
permalink: /docs/playermarket/searching
sponsorship: true
---

自 `1.0.5` 开始，支持根据关键词搜索商品。

## 界面配置

在全球市场界面配置中，修改以下内容。被注释的配置用于位置参考，仅添加未被注释的配置即可。
```yaml
#  刷:
#    material: SNOWBALL
#    display: '&e&l刷新'
#    lore:
#      - ''
#      - '&a左键 &7| &f刷新商店菜单'
#      - '&b右键 &7| &f查看我的商品列表'
      # 显示当前关键词，显示搜索操作提示
      - ''
      - '  &f关键词: &e%search_keyword%'
      - ''
      - '&eShift+左键 &7| &f按关键词搜索商品'
      - '&dShift+右键 &7| &f清空关键词'
#    left-click-commands:
#      - '[refresh]'
#    right-click-commands:
#      - '[player]sweetplayermarket me'
    # 在聊天栏输入关键词
    shift-left-click-commands:
      - '[search:keyword]'
    # 重置关键词
    shift-right-click-commands:
      - '[search:keyword]reset'
```

玩家执行 `'[search:keyword]'` 操作时，将会关闭界面，要求玩家输入关键词，输入后自动重新打开界面并搜索。

## 语言文件

在 1.19.4+ 等支持 [Translatable](https://javadoc.mcio.dev/spigot/1.19.4/org/bukkit/Translatable.html) 特性的服务端版本，插件会根据服务端版本，自动下载语言文件到 `plugins/SweetPlayerMarket/versions/版本/` 中。

如果语言或游戏版本不正确，可以到 `plugins/SweetPlayerMarket/versions/config.yml` 中设置，并执行命令 `/pm reload assets` 重新下载。

语言文件的保存形式与 Minecraft 客户端差不多
+ 客户端的 `.minecraft/assets/indexes/*.json` 对应 `plugins/SweetPlayerMarket/versions/版本/assetIndex.json`
+ 客户端的 `.minecraft/assets/objects/` 对应 `plugins/SweetPlayerMarket/versions/版本/objects/`

如果你有客户端编辑经验，应当很容易就能修改语言文件。由于不存在可执行文件，插件不会对下载的文件进行校验，可随意修改。

针对 CraftEngine 等注入真实物品到服务器中的插件，可以修改语言文件来添加这些物品的搜索索引名称支持。

最后，执行命令 `/pm recalc index` 来重新计算索引即可。

## SQLite 额外配置

> 如果使用 MySQL，无需进行这个配置

由于 SQLite 默认的 tokenizer 不支持中文搜索，需要额外添加扩展，才允许启用搜索功能。

+ 到 Simple Tokenizer 的 [Releases](https://github.com/wangfenjin/simple/releases/latest) 下载适合自己服务器系统架构的发行版
+ 解压到 `/plugins/SweetPlayerMarket/sqlite/` 中，确保层级正确，即 `sqlite` 目录中存在动态链接库文件（`simple.dll` 或 `libsimple.so` 或 `libsimple.dylib`）
+ 重启服务器，或执行命令 `/pm reload database` 重新连接数据库
